# ğŸ¤– AIãƒªã‚µãƒ¼ãƒãƒ£ãƒ¼Bot

![Bot Banner](https://user-images.githubusercontent.com/8409099/200548054-882e3262-843a-439a-a4a9-635346a75791.png)

**AIãƒªã‚µãƒ¼ãƒãƒ£ãƒ¼Bot**ã¯ã€ã‚ãªãŸã®ä»£ã‚ã‚Šã«æœ€æ–°ã®æƒ…å ±ã‚’Webã§æ¤œç´¢ã—ã€ãã®å†…å®¹ã‚’AIãŒåˆ†ã‹ã‚Šã‚„ã™ãè¦ç´„ã—ã¦æ•™ãˆã¦ãã‚Œã‚‹ã€ã‚ãªãŸã®å°‚å±ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚

## âœ¨ ä¸»ãªæ©Ÿèƒ½

-   **ğŸŒ Webæ¤œç´¢æ©Ÿèƒ½**: å…¥åŠ›ã•ã‚ŒãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«åŸºã¥ã„ã¦ã€é–¢é€£æ€§ã®é«˜ã„æƒ…å ±ã‚’Webã‹ã‚‰åé›†ã—ã¾ã™ã€‚
-   **ğŸ§  AIã«ã‚ˆã‚‹è¦ç´„**: åé›†ã—ãŸæƒ…å ±ã‚’å¼·åŠ›ãªAIãŒåˆ†æã—ã€é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã‚’ç°¡æ½”ã«ã¾ã¨ã‚ã¦è¿”ä¿¡ã—ã¾ã™ã€‚
-   **ğŸ’¬ å¯¾è©±å½¢å¼ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**: ã„ã¤ã‚‚ã®LINEã®ãƒˆãƒ¼ã‚¯ç”»é¢ã§ã€æ°—è»½ã«è³ªå•ã™ã‚‹ã ã‘ã§åˆ©ç”¨ã§ãã¾ã™ã€‚

## ä½¿ã„æ–¹

ä½¿ã„æ–¹ã¯ã¨ã¦ã‚‚ç°¡å˜ã§ã™ï¼

1.  ã“ã®LINEå…¬å¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ã€Œå‹ã ã¡è¿½åŠ ã€ã—ã¾ã™ã€‚
2.  ãƒˆãƒ¼ã‚¯ç”»é¢ã§ã€çŸ¥ã‚ŠãŸã„ã“ã¨ã‚„èª¿ã¹ã¦ã»ã—ã„ã“ã¨ã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§é€ä¿¡ã—ã¾ã™ã€‚

ã“ã‚Œã ã‘ã§ã€BotãŒè‡ªå‹•çš„ã«ãƒªã‚µãƒ¼ãƒã‚’é–‹å§‹ã—ã¾ã™ã€‚

> **ğŸ’¡ ãƒ’ãƒ³ãƒˆ**
> ã€Œã€‡ã€‡ã«ã¤ã„ã¦æ•™ãˆã¦ã€ã€Œã€‡ã€‡ã¨ã¯ï¼Ÿã€ã®ã‚ˆã†ã«ã€å…·ä½“çš„ãªè³ªå•ã‚’ã™ã‚‹ã¨ã€ã‚ˆã‚Šç²¾åº¦ã®é«˜ã„å›ç­”ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

## ğŸ—£ï¸ ä¼šè©±ã®ä¾‹

**ã‚ãªãŸ:**
`æœ€è¿‘ã®å††å®‰ã®åŸå› ã¨ä»Šå¾Œã®è¦‹é€šã—ã«ã¤ã„ã¦æ•™ãˆã¦`

**AIãƒªã‚µãƒ¼ãƒãƒ£ãƒ¼Bot:**
`AIãŒæƒ…å ±ã‚’æ¤œç´¢ãƒ»è¦ç´„ä¸­ã§ã™ã€‚ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„...`

**(ã—ã°ã‚‰ãã—ã¦)**

**AIãƒªã‚µãƒ¼ãƒãƒ£ãƒ¼Bot:**
`æœ€è¿‘ã®å††å®‰ã®ä¸»ãªåŸå› ã¯ã€æ—¥ç±³ã®é‡‘åˆ©å·®ã®æ‹¡å¤§ã«ã‚ã‚Šã¾ã™ã€‚ã‚¢ãƒ¡ãƒªã‚«ãŒã‚¤ãƒ³ãƒ•ãƒ¬æŠ‘åˆ¶ã®ãŸã‚ã«åˆ©ä¸Šã’ã‚’ç¶šã‘ã‚‹ä¸€æ–¹ã€æ—¥æœ¬ã¯é‡‘èç·©å’Œã‚’ç¶­æŒã—ã¦ã„ã‚‹ãŸã‚ã€ãƒ‰ãƒ«ã‚’è²·ã£ã¦å††ã‚’å£²ã‚‹å‹•ããŒåŠ é€Ÿã—ã¦ã„ã¾ã™ã€‚ä»Šå¾Œã®è¦‹é€šã—ã«ã¤ã„ã¦ã¯ã€å°‚é–€å®¶ã®é–“ã§ã‚‚æ„è¦‹ãŒåˆ†ã‹ã‚Œã¦ã„ã¾ã™ãŒã€...`

## âš ï¸ ã”åˆ©ç”¨ã«ã‚ãŸã£ã¦ã®æ³¨æ„

-   AIã«ã‚ˆã‚‹è¦ç´„å‡¦ç†ã«ã¯ã€æ•°åç§’ã€œ1åˆ†ç¨‹åº¦ã®æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚æœ€åˆã«ã€Œå‡¦ç†ä¸­ã§ã™ã€ã¨ã„ã†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šãã¾ã™ã®ã§ã€ãã®ã¾ã¾ãŠå¾…ã¡ãã ã•ã„ã€‚
-   ç”Ÿæˆã•ã‚Œã‚‹æƒ…å ±ã¯ã€Webä¸Šã®ãƒ‡ãƒ¼ã‚¿ã‚’å…ƒã«ã—ãŸAIã«ã‚ˆã‚‹è¦ç´„ã§ã‚ã‚Šã€ãã®æ­£ç¢ºæ€§ã‚’ä¿è¨¼ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚é‡è¦ãªåˆ¤æ–­ã‚’è¡Œã†éš›ã¯ã€å¿…ãšè¤‡æ•°ã®æƒ…å ±æºã‚’ã”ç¢ºèªãã ã•ã„ã€‚

---

## ä»®æƒ³ç’°å¢ƒç«‹ã¡ä¸Šã’
cd /Users/tomoki33/Desktop/linebot
python3 -m venv venv
source venv/bin/activate  # Windowsãªã‚‰ venv\Scripts\activate
pip install -r requirements.txt

## ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œ
python test_search.py

## LINE Official Account Managerã®è¨­å®š (é‡è¦)
LINE BotãŒæ­£ã—ãå¿œç­”ã—ãªã„å ´åˆã€ä»¥ä¸‹ã®è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
1. [LINE Official Account Manager](https://www.linebiz.com/jp/login/)ã«ãƒ­ã‚°ã‚¤ãƒ³
2. å¯¾è±¡ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é¸æŠã—ã€å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ã€Œ**å¿œç­”è¨­å®š**ã€ã‚’é–‹ã
3. **å¿œç­”ãƒ¢ãƒ¼ãƒ‰**ã‚’ã€Œ**Bot**ã€ã«è¨­å®šã™ã‚‹
4. **è©³ç´°è¨­å®š** > **å¿œç­”ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ã‚’ã€Œ**ã‚ªãƒ•**ã€ã«è¨­å®šã™ã‚‹

## ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é † (ã‚³ãƒ¼ãƒ‰ä¿®æ­£å¾Œãªã©)

### 1. AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã®ç¢ºèªã¨è¨­å®š
# ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã€12æ¡ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚
aws sts get-caller-identity --query Account --output text

# ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã® <ACCOUNT_ID> ã‚’ã€ã‚³ãƒ”ãƒ¼ã—ãŸIDã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

### 2. ECRãƒ­ã‚°ã‚¤ãƒ³
# 1æ™‚é–“ã«1å›ç¨‹åº¦ã€å®Ÿè¡ŒãŒå¿…è¦ã§ã™ã€‚
aws ecr get-login-password --region ap-northeast-1 | docker login --username AWS --password-stdin <ACCOUNT_ID>.dkr.ecr.ap-northeast-1.amazonaws.com

### 3. Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰ã¨ãƒ—ãƒƒã‚·ãƒ¥
# ãƒ“ãƒ«ãƒ‰ (buildxã‚’ä½¿ã„ã€x86_64ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’å¼·åˆ¶)
docker buildx build --platform linux/amd64 -t line-bot-repo --load .

# ã‚¿ã‚°ä»˜ã‘
docker tag line-bot-repo:latest <ACCOUNT_ID>.dkr.ecr.ap-northeast-1.amazonaws.com/line-bot-repo:latest

# ãƒ—ãƒƒã‚·ãƒ¥
docker push <ACCOUNT_ID>.dkr.ecr.ap-northeast-1.amazonaws.com/line-bot-repo:latest

### 4. Terraformã®é©ç”¨
terraform apply \
  -var="line_channel_access_token=$(grep LINE_CHANNEL_ACCESS_TOKEN .env | cut -d '=' -f2)" \
  -var="openai_api_key=$(grep OPENAI_API_KEY .env | cut -d '=' -f2)" \
  -var="google_api_key=$(grep GOOGLE_API_KEY .env | cut -d '=' -f2)" \
  -var="google_cse_id=$(grep GOOGLE_CSE_ID .env | cut -d '=' -f2)"

---
### åˆå›ã®ã¿ï¼šãƒ“ãƒ«ãƒ‰ç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
# buildxç”¨ã®æ–°ã—ã„ãƒ“ãƒ«ãƒ€ãƒ¼ã‚’ä½œæˆã—ã€æœ‰åŠ¹åŒ–ã—ã¾ã™ (ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä¸€åº¦ã ã‘å®Ÿè¡Œã™ã‚Œã°OKã§ã™)
docker buildx create --name mybuilder --use
docker buildx inspect --bootstrap

